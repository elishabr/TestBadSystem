/*
 * File: gammainc.c
 *
 * MATLAB Coder version            : 25.2
 * C/C++ source code generated on  : 23-Jan-2026 19:07:19
 */

/* Include Files */
#include "gammainc.h"
#include "rt_nonfinite.h"
#include "rt_nonfinite.h"
#include <math.h>

/* Function Definitions */
/*
 * Arguments    : double x
 *                double a
 * Return Type  : creal_T
 */
creal_T gammainc(double x, double a)
{
  static const double table100[100] = {0.0,
                                       0.0,
                                       0.69314718055994529,
                                       1.791759469228055,
                                       3.1780538303479458,
                                       4.7874917427820458,
                                       6.5792512120101012,
                                       8.5251613610654147,
                                       10.604602902745251,
                                       12.801827480081469,
                                       15.104412573075516,
                                       17.502307845873887,
                                       19.987214495661885,
                                       22.552163853123425,
                                       25.19122118273868,
                                       27.89927138384089,
                                       30.671860106080672,
                                       33.505073450136891,
                                       36.395445208033053,
                                       39.339884187199495,
                                       42.335616460753485,
                                       45.380138898476908,
                                       48.471181351835227,
                                       51.606675567764377,
                                       54.784729398112319,
                                       58.003605222980518,
                                       61.261701761002,
                                       64.557538627006338,
                                       67.88974313718154,
                                       71.257038967168015,
                                       74.658236348830158,
                                       78.0922235533153,
                                       81.557959456115043,
                                       85.054467017581516,
                                       88.580827542197682,
                                       92.1361756036871,
                                       95.7196945421432,
                                       99.330612454787428,
                                       102.96819861451381,
                                       106.63176026064346,
                                       110.32063971475739,
                                       114.03421178146171,
                                       117.77188139974507,
                                       121.53308151543864,
                                       125.3172711493569,
                                       129.12393363912722,
                                       132.95257503561632,
                                       136.80272263732635,
                                       140.67392364823425,
                                       144.5657439463449,
                                       148.47776695177302,
                                       152.40959258449735,
                                       156.3608363030788,
                                       160.3311282166309,
                                       164.32011226319517,
                                       168.32744544842765,
                                       172.35279713916279,
                                       176.39584840699735,
                                       180.45629141754378,
                                       184.53382886144948,
                                       188.6281734236716,
                                       192.7390472878449,
                                       196.86618167289,
                                       201.00931639928152,
                                       205.1681994826412,
                                       209.34258675253685,
                                       213.53224149456327,
                                       217.73693411395422,
                                       221.95644181913033,
                                       226.1905483237276,
                                       230.43904356577696,
                                       234.70172344281826,
                                       238.97838956183432,
                                       243.26884900298271,
                                       247.57291409618688,
                                       251.89040220972319,
                                       256.22113555000954,
                                       260.56494097186322,
                                       264.92164979855278,
                                       269.29109765101981,
                                       273.67312428569369,
                                       278.06757344036612,
                                       282.4742926876304,
                                       286.893133295427,
                                       291.32395009427029,
                                       295.76660135076065,
                                       300.22094864701415,
                                       304.68685676566872,
                                       309.1641935801469,
                                       313.65282994987905,
                                       318.1526396202093,
                                       322.66349912672615,
                                       327.1852877037752,
                                       331.71788719692847,
                                       336.26118197919845,
                                       340.815058870799,
                                       345.37940706226686,
                                       349.95411804077025,
                                       354.53908551944079,
                                       359.1342053695754};
  static const double dv[31] = {0.0,
                                0.15342640972002736,
                                0.081061466795327261,
                                0.054814121051917651,
                                0.0413406959554093,
                                0.033162873519936291,
                                0.027677925684998338,
                                0.023746163656297496,
                                0.020790672103765093,
                                0.018488450532673187,
                                0.016644691189821193,
                                0.015134973221917378,
                                0.013876128823070748,
                                0.012810465242920227,
                                0.01189670994589177,
                                0.011104559758206917,
                                0.010411265261972096,
                                0.0097994161261588039,
                                0.0092554621827127329,
                                0.0087687001341393862,
                                0.00833056343336287,
                                0.00793411456431402,
                                0.0075736754879518406,
                                0.007244554301320383,
                                0.00694284010720953,
                                0.0066652470327076821,
                                0.0064089941880042071,
                                0.0061717122630394576,
                                0.0059513701127588475,
                                0.0057462165130101155,
                                0.0055547335519628011};
  static const double p1[8] = {4.9452353592967269, 201.8112620856775,
                               2290.8383738313464, 11319.672059033808,
                               28557.246356716354, 38484.962284437934,
                               26377.487876241954, 7225.8139797002877};
  static const double p2[8] = {4.974607845568932,     542.4138599891071,
                               15506.938649783649,    184793.29044456323,
                               1.0882047694688288E+6, 3.33815296798703E+6,
                               5.1066616789273527E+6, 3.0741090548505397E+6};
  static const double p4[8] = {14745.0216605994,       2.4268133694867045E+6,
                               1.2147555740450932E+8,  2.6634324496309772E+9,
                               2.9403789566345539E+10, 1.7026657377653989E+11,
                               4.926125793377431E+11,  5.6062518562239514E+11};
  static const double q1[8] = {67.482125503037778, 1113.3323938571993,
                               7738.7570569353984, 27639.870744033407,
                               54993.102062261576, 61611.221800660023,
                               36351.2759150194,   8785.5363024310136};
  static const double q2[8] = {183.03283993705926,    7765.0493214450062,
                               133190.38279660742,    1.1367058213219696E+6,
                               5.2679641174379466E+6, 1.3467014543111017E+7,
                               1.7827365303532742E+7, 9.5330955918443538E+6};
  static const double q4[8] = {2690.5301758708993,     639388.56543000927,
                               4.1355999302413881E+7,  1.120872109616148E+9,
                               1.4886137286788137E+10, 1.0168035862724382E+11,
                               3.4174763455073773E+11, 4.4631581874197131E+11};
  static const double c[7] = {-0.001910444077728,      0.00084171387781295,
                              -0.00059523799130430121, 0.0007936507935003503,
                              -0.0027777777777776816,  0.083333333333333329,
                              0.0057083835261};
  creal_T b;
  double la;
  double lgap11;
  double twoa;
  int i;
  lgap11 = a + 1.0;
  if ((!rtIsNaN(a + 1.0)) && (!(a + 1.0 < 0.0))) {
    if (a + 1.0 > 2.55E+305) {
      lgap11 = rtInf;
    } else if (a + 1.0 <= 2.2204460492503131E-16) {
      lgap11 = -log(a + 1.0);
    } else if (a + 1.0 <= 0.5) {
      lgap11 = 1.0;
      twoa = 0.0;
      for (i = 0; i < 8; i++) {
        twoa = twoa * (a + 1.0) + p1[i];
        lgap11 = lgap11 * (a + 1.0) + q1[i];
      }
      lgap11 = -log(a + 1.0) +
               (a + 1.0) * ((a + 1.0) * (twoa / lgap11) - 0.57721566490153287);
    } else if (a + 1.0 <= 0.6796875) {
      lgap11 = 1.0;
      twoa = 0.0;
      for (i = 0; i < 8; i++) {
        twoa = twoa * (((a + 1.0) - 0.5) - 0.5) + p2[i];
        lgap11 = lgap11 * (((a + 1.0) - 0.5) - 0.5) + q2[i];
      }
      lgap11 =
          -log(a + 1.0) + (((a + 1.0) - 0.5) - 0.5) *
                              ((((a + 1.0) - 0.5) - 0.5) * (twoa / lgap11) +
                               0.42278433509846713);
    } else if ((a + 1.0 == floor(a + 1.0)) && (a + 1.0 <= 100.0)) {
      lgap11 = table100[(int)(a + 1.0) - 1];
    } else if (a + 1.0 <= 1.5) {
      lgap11 = 1.0;
      twoa = 0.0;
      for (i = 0; i < 8; i++) {
        twoa = twoa * (((a + 1.0) - 0.5) - 0.5) + p1[i];
        lgap11 = lgap11 * (((a + 1.0) - 0.5) - 0.5) + q1[i];
      }
      lgap11 =
          (((a + 1.0) - 0.5) - 0.5) *
          ((((a + 1.0) - 0.5) - 0.5) * (twoa / lgap11) - 0.57721566490153287);
    } else if (a + 1.0 <= 4.0) {
      lgap11 = 1.0;
      twoa = 0.0;
      for (i = 0; i < 8; i++) {
        twoa = twoa * ((a + 1.0) - 2.0) + p2[i];
        lgap11 = lgap11 * ((a + 1.0) - 2.0) + q2[i];
      }
      lgap11 = ((a + 1.0) - 2.0) *
               (((a + 1.0) - 2.0) * (twoa / lgap11) + 0.42278433509846713);
    } else if (a + 1.0 <= 12.0) {
      lgap11 = -1.0;
      twoa = 0.0;
      for (i = 0; i < 8; i++) {
        twoa = twoa * ((a + 1.0) - 4.0) + p4[i];
        lgap11 = lgap11 * ((a + 1.0) - 4.0) + q4[i];
      }
      lgap11 = ((a + 1.0) - 4.0) * (twoa / lgap11) + 1.791759469228055;
    } else {
      if (a + 1.0 <= 2.25E+76) {
        twoa = 0.0057083835261;
        lgap11 = 1.0 / ((a + 1.0) * (a + 1.0));
        for (i = 0; i < 6; i++) {
          twoa = twoa * lgap11 + c[i];
        }
        twoa /= a + 1.0;
      } else {
        twoa = 0.0;
      }
      lgap11 = log(a + 1.0);
      lgap11 = ((twoa + 0.91893853320467278) - 0.5 * lgap11) +
               (a + 1.0) * (lgap11 - 1.0);
    }
  }
  la = log(a);
  if (!(a > 0.0)) {
    if (a == 0.0) {
      lgap11 = 0.0;
    } else {
      lgap11 = rtNaN;
    }
  } else if (rtIsInf(a)) {
    if (rtIsInf(x)) {
      lgap11 = rtNaN;
    } else {
      lgap11 = 1.0;
    }
  } else if (rtIsInf(x)) {
    lgap11 = 0.0;
  } else {
    double a1;
    double fac;
    double logpax;
    double sqrtx;
    double stirlerr;
    double t;
    double tsq;
    double xD0;
    int exitg1;
    if (a <= 15.0) {
      twoa = 2.0 * a;
      if (twoa == floor(twoa)) {
        stirlerr = dv[(int)(twoa + 1.0) - 1];
      } else {
        stirlerr = ((lgap11 - (a + 0.5) * la) + a) - 0.91893853320467267;
      }
    } else {
      lgap11 = a * a;
      stirlerr = ((((0.00084175084175084171 / lgap11 - 0.00059523809523809529) /
                        lgap11 +
                    0.00079365079365079365) /
                       lgap11 -
                   0.0027777777777777779) /
                      lgap11 +
                  0.083333333333333329) /
                 a;
    }
    fac = a - x;
    a1 = a + x;
    if (fabs(fac) > 0.1 * a1) {
      if (a < 2.2250738585072014E-308 * x) {
        xD0 = x;
      } else if ((x < 1.0) && (a > 1.7976931348623157E+308 * x)) {
        xD0 = (a * la - a * log(x)) - a;
      } else {
        xD0 = (a * log(a / x) + x) - a;
      }
    } else {
      t = x / a;
      lgap11 = (1.0 - t) / (t + 1.0);
      tsq = lgap11 * lgap11;
      xD0 = fac * lgap11;
      sqrtx = xD0;
      lgap11 = 2.0 * (a * lgap11);
      twoa = 3.0;
      do {
        exitg1 = 0;
        lgap11 *= tsq;
        xD0 += lgap11 / twoa;
        if (xD0 == sqrtx) {
          exitg1 = 1;
        } else {
          sqrtx = xD0;
          twoa += 2.0;
        }
      } while (exitg1 == 0);
    }
    logpax = (-0.5 * (la + 1.8378770664093453) - stirlerr) - xD0;
    if (x > 1.0E+6) {
      sqrtx = sqrt(x);
      t = fabs(fac - 1.0) / sqrtx;
      tsq = t * t;
      if (t < 15.0) {
        lgap11 = 0.70710678118654746 * t;
        twoa = 3.97886080735226 / (lgap11 + 3.97886080735226);
        a1 = 0.5 *
             ((((((((((((((((((((((0.0012710976495261409 * (twoa - 0.5) +
                                   0.00011931402283834095) *
                                      (twoa - 0.5) -
                                  0.0039638509736051354) *
                                     (twoa - 0.5) -
                                 0.00087077963531729586) *
                                    (twoa - 0.5) +
                                0.0077367252831352668) *
                                   (twoa - 0.5) +
                               0.0038333512626488732) *
                                  (twoa - 0.5) -
                              0.012722381378212275) *
                                 (twoa - 0.5) -
                             0.013382364453346007) *
                                (twoa - 0.5) +
                            0.016131532973325226) *
                               (twoa - 0.5) +
                           0.039097684558848406) *
                              (twoa - 0.5) +
                          0.0024936720005350331) *
                             (twoa - 0.5) -
                         0.0838864557023002) *
                            (twoa - 0.5) -
                        0.11946395996432542) *
                           (twoa - 0.5) +
                       0.016620792496936737) *
                          (twoa - 0.5) +
                      0.35752427444953105) *
                         (twoa - 0.5) +
                     0.80527640875291062) *
                        (twoa - 0.5) +
                    1.1890298290927332) *
                       (twoa - 0.5) +
                   1.3704021768233816) *
                      (twoa - 0.5) +
                  1.313146538310231) *
                     (twoa - 0.5) +
                 1.0792551515585667) *
                    (twoa - 0.5) +
                0.77436819911953858) *
                   (twoa - 0.5) +
               0.49016508058531844) *
                  (twoa - 0.5) +
              0.27537474159737679) *
             twoa * exp(-lgap11 * lgap11) * 2.5066282746310002 * exp(0.5 * tsq);
        twoa = (a1 * ((tsq - 3.0) * t) - (tsq - 4.0)) / 6.0;
        xD0 = (a1 * ((tsq * tsq - 9.0) * tsq + 6.0) -
               ((tsq - 1.0) * tsq - 6.0) * t) /
              72.0;
        lgap11 = 5.0 * tsq;
        lgap11 =
            (a1 * (((((lgap11 + 45.0) * tsq - 81.0) * tsq - 315.0) * tsq +
                    270.0) *
                   t) -
             ((((lgap11 + 40.0) * tsq - 111.0) * tsq - 174.0) * tsq + 192.0)) /
            6480.0;
      } else {
        a1 = (((3.0 - 15.0 / tsq) / tsq - 1.0) / tsq + 1.0) / t;
        twoa = (((25.0 - 210.0 / tsq) / tsq - 4.0) / tsq + 1.0) / tsq;
        xD0 = (((130.0 - 1750.0 / tsq) / tsq - 11.0) / tsq + 1.0) / (tsq * t);
        lgap11 =
            (((546.0 - 11368.0 / tsq) / tsq - 26.0) / tsq + 1.0) / (tsq * tsq);
      }
      if (x < a - 1.0) {
        lgap11 = a * (((a1 / sqrtx - twoa / x) + xD0 / (x * sqrtx)) -
                      lgap11 / (x * x));
        if (logpax < 709.782712893384) {
          lgap11 *= exp(logpax);
        } else {
          lgap11 = exp(logpax + log(lgap11));
        }
        lgap11 = 1.0 - lgap11;
      } else {
        lgap11 = a * (((a1 / sqrtx + twoa / x) + xD0 / (x * sqrtx)) +
                      lgap11 / (x * x));
        if (logpax < 709.782712893384) {
          lgap11 *= exp(logpax);
        } else {
          lgap11 = exp(logpax + log(lgap11));
        }
      }
    } else if (x < a) {
      int b_i;
      t = 1.0;
      if (x > 2.2204460492503131E-16 * a) {
        fac = x / a;
        t = 2.0;
        do {
          exitg1 = 0;
          fac = x * fac / (a + (t - 1.0));
          if (fac < 2.2204460492503131E-16) {
            exitg1 = 1;
          } else {
            t++;
          }
        } while (exitg1 == 0);
      }
      lgap11 = 0.0;
      b_i = (int)-((-1.0 - (t - 1.0)) + 1.0);
      for (i = 0; i < b_i; i++) {
        lgap11 = x * (lgap11 + 1.0) / (a + ((t - 1.0) - (double)i));
      }
      lgap11++;
      if (logpax < 709.782712893384) {
        lgap11 *= exp(logpax);
      } else {
        lgap11 = exp(logpax + log(lgap11));
      }
      if (lgap11 > 1.0) {
        lgap11 = 1.0;
      }
      lgap11 = 1.0 - lgap11;
    } else {
      int b_i;
      fac = 1.0;
      t = 1.0;
      do {
        exitg1 = 0;
        lgap11 = floor(a1);
        if (t <= lgap11) {
          fac = (a - t) * fac / x;
          if (fabs(fac) < 2.2204460492503131E-16) {
            exitg1 = 1;
          } else {
            t++;
          }
        } else {
          exitg1 = 1;
        }
      } while (exitg1 == 0);
      if (t <= lgap11) {
        lgap11 = 1.0;
      } else {
        la = floor(a);
        twoa = a - la;
        if (twoa == 0.0) {
          lgap11 = 1.0;
          t = la;
        } else {
          xD0 = 1.0;
          a1 = x;
          tsq = 0.0;
          stirlerr = 1.0;
          fac = 1.0 / x;
          t = 1.0;
          lgap11 = fac;
          sqrtx = 0.0;
          while (fabs(lgap11 - sqrtx) > 2.2204460492503131E-16 * lgap11) {
            sqrtx = lgap11;
            lgap11 = t - twoa;
            xD0 = (a1 + xD0 * lgap11) * fac;
            tsq = (stirlerr + tsq * lgap11) * fac;
            lgap11 = t * fac;
            a1 = x * xD0 + lgap11 * a1;
            stirlerr = x * tsq + lgap11 * stirlerr;
            fac = 1.0 / a1;
            lgap11 = stirlerr * fac;
            t++;
          }
          lgap11 *= x;
          t = la + 1.0;
        }
      }
      b_i = (int)-((-1.0 - (t - 1.0)) + 1.0);
      for (i = 0; i < b_i; i++) {
        lgap11 = (a - ((t - 1.0) - (double)i)) * lgap11 / x + 1.0;
      }
      lgap11 = lgap11 * a / x;
      if (logpax < 709.782712893384) {
        lgap11 *= exp(logpax);
      } else {
        lgap11 = exp(logpax + log(lgap11));
      }
      if (lgap11 > 1.0) {
        lgap11 = 1.0;
      }
    }
  }
  b.re = lgap11;
  b.im = 0.0;
  return b;
}

/*
 * File trailer for gammainc.c
 *
 * [EOF]
 */
